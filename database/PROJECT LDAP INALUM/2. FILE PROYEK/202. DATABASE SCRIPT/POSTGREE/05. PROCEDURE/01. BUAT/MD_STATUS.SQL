CREATE OR REPLACE FUNCTION P_ISI_MD_STATUS(
	KD_STATUS1 character varying,
	NM_STATUS1 character varying,
	KETERANGAN1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_STATUS WHERE KD_STATUS = KD_STATUS1;
	IF CACAH > 0 THEN
		UPDATE MD_STATUS SET NM_STATUS = NM_STATUS1, KETERANGAN = KETERANGAN1 WHERE KD_STATUS = KD_STATUS1;
	ELSE
		INSERT INTO MD_STATUS VALUES(KD_STATUS1, NM_STATUS1, KETERANGAN1);
	END IF;

	RETURN 'OKE';
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;


-- DELETE
CREATE OR REPLACE FUNCTION P_DEL_MD_STATUS(
	KD_STATUS1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	ERR_MSG VARCHAR;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_STATUS WHERE KD_STATUS = KD_STATUS1;
	IF CACAH > 0 THEN
		DELETE FROM MD_STATUS WHERE KD_STATUS = KD_STATUS1;
		ERR_MSG := 'OKE';
	ELSE
		ERR_MSG := 'GAGAL';
	END IF;

	RETURN ERR_MSG;
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;