CREATE OR REPLACE FUNCTION P_ISI_MD_USER(
	KD_USER1 character varying,
	NAMA_USER1 character varying,
	EMAIL_USER1 character varying,
	PASSWORD_USER1 character varying,
	STATUS_USER1 character varying,
	ALAMAT_USER1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	ERR_MSG VARCHAR;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_USER WHERE KD_USER = KD_USER1;
	ERR_MSG := 'USER TIDAK DITEMUKAN';
	IF CACAH > 0 THEN
		UPDATE MD_USER SET NM_USER = NAMA_USER1, EMAIL = EMAIL_USER1, PASSWORD = PASSWORD_USER1, STATUS = STATUS_USER1, ALAMAT = ALAMAT_USER1 WHERE KD_USER = KD_USER1;
	ELSE
		INSERT INTO MD_USER VALUES(KD_USER1, NAMA_USER1, EMAIL_USER1, PASSWORD_USER1, STATUS_USER1, ALAMAT_USER1);
	END IF;

	RETURN 'OKE';
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;


-- DELETE
CREATE OR REPLACE FUNCTION P_DEL_MD_USER(
	KD_USER1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	ERR_MSG VARCHAR;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_USER WHERE KD_USER = KD_USER1;
	IF CACAH > 0 THEN
		DELETE FROM MD_USER WHERE KD_USER = KD_USER1;
		ERR_MSG := 'OKE';
	ELSE
		ERR_MSG := 'GAGAL';
	END IF;

	RETURN ERR_MSG;
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;