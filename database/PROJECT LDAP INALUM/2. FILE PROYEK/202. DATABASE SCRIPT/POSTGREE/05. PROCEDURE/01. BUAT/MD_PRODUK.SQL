CREATE OR REPLACE FUNCTION P_ISI_MD_PRODUK(
	KD_PRODUK1 character varying,
	NM_PRODUK1 character varying,
	DESKRIPSI1 character varying,
	TARIF_PRODUK1 character varying,
	KETERANGAN1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	PESAN_ERROR VARCHAR;

BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_PRODUK WHERE KD_PRODUK = KD_PRODUK1;
	IF CACAH > 0 THEN
		UPDATE MD_PRODUK SET NM_PRODUK = NM_PRODUK1, DESKRIPSI = DESKRIPSI1, TARIF_PRODUK = TARIF_PRODUK1, KETERANGAN = KETERANGAN1 WHERE KD_PRODUK = KD_PRODUK1;
	ELSE
		INSERT INTO MD_PRODUK (KD_PRODUK, NM_PRODUK, DESKRIPSI, TARIF_PRODUK, KETERANGAN) VALUES (KD_PRODUK1, NM_PRODUK1, DESKRIPSI1, TARIF_PRODUK1, KETERANGAN1);
	END IF;

	RETURN 'OKE';
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;


-- DELETE
CREATE OR REPLACE FUNCTION P_DEL_MD_PRODUK(
	KD_PRODUK1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	ERR_MSG VARCHAR;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_PRODUK WHERE KD_PRODUK = KD_PRODUK1;
	IF CACAH > 0 THEN
		DELETE FROM MD_PRODUK WHERE KD_PRODUK = KD_PRODUK1;
		ERR_MSG := 'OKE';
	ELSE
		ERR_MSG := 'GAGAL';
	END IF;

	RETURN ERR_MSG;
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;