-- DROP TABLE IF EXISTS PEGAWAI.D_PEGAWAI;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_PEGAWAI(
    UID_USER	            VARCHAR	(50),
    KD_SEKSI	            VARCHAR	(10),
    KD_DEPARTEMEN	        VARCHAR	(10),
    KD_DIREKSI	            VARCHAR	(10),
    TANGGAL_MPP	            DATE,
    TANGGAL_PENSIUN	        DATE,
    TANGGAL_MASUK	        DATE,
    KD_JABATAN_AKHIR	    VARCHAR	(10),
    KD_PANGKAT_AKHIR	    VARCHAR	(10),
    KD_BOD_AKHIR	        VARCHAR	(10),
    KD_KELOMPOK_TUGAS_AKHIR	VARCHAR	(10),
    KD_STATUS_PEGAWAI	    VARCHAR	(10),
    KD_STATUS_NIKAH	        VARCHAR	(10),
	IS_DELETED 		        BOOLEAN DEFAULT FALSE,
    STATUS	                STATUS DEFAULT 'A',

    ALAMAT                  VARCHAR (1000),
    KD_PROVINSI	            INTEGER,
    KD_KABUPATEN	        INTEGER,
    KD_KECAMATAN	        INTEGER,
    KD_DESA	                INTEGER,

    TEMPAT_LAHIR	        VARCHAR	(1000),
    TANGGAL_LAHIR	        DATE,
    ALAMAT_ASAL	            VARCHAR	(1000),
    KD_PROVINSI_ASAL	    INTEGER,
    KD_KABUPATEN_ASAL	    INTEGER,
    KD_KECAMATAN_ASAL	    INTEGER,
    KD_DESA_ASAL	        INTEGER,

    PRIMARY KEY (UID_USER),
    CONSTRAINT FK_D_PEGAWAI_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_SEKSI FOREIGN KEY (KD_SEKSI) REFERENCES MD_SEKSI(KD_SEKSI)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_DEPARTEMEN FOREIGN KEY (KD_DEPARTEMEN) REFERENCES MD_DEPARTEMEN(KD_DEPARTEMEN)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_DIREKSI FOREIGN KEY (KD_DIREKSI) REFERENCES MD_DIREKSI(KD_DIREKSI)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_JABATAN FOREIGN KEY (KD_JABATAN_AKHIR) REFERENCES MD_JABATAN(KD_JABATAN)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_PANGKAT FOREIGN KEY (KD_PANGKAT_AKHIR) REFERENCES MD_PANGKAT(KD_PANGKAT)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_BOD FOREIGN KEY (KD_BOD_AKHIR) REFERENCES MD_BOD(KD_BOD)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_KELOMPOK FOREIGN KEY (KD_KELOMPOK_TUGAS_AKHIR) REFERENCES MD_KELOMPOK_TUGAS(KD_KELOMPOK_TUGAS)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_STATUS_PEGAWAI FOREIGN KEY (KD_STATUS_PEGAWAI) REFERENCES MD_STATUS_PEGAWAI(KD_STATUS_PEGAWAI)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_STATUS_NIKAH FOREIGN KEY (KD_STATUS_NIKAH) REFERENCES MD_STATUS_NIKAH(KD_STATUS_NIKAH) ON UPDATE CASCADE ON DELETE RESTRICT,

    CONSTRAINT FK_D_PEGAWAI_KD_PROVINSI FOREIGN KEY (KD_PROVINSI) REFERENCES MD_PROVINSI(KD_PROVINSI) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_KABUPATEN FOREIGN KEY (KD_KABUPATEN) REFERENCES MD_KABUPATEN(KD_KABUPATEN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_KECAMATAN FOREIGN KEY (KD_KECAMATAN) REFERENCES MD_KECAMATAN(KD_KECAMATAN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_DESA FOREIGN KEY (KD_DESA) REFERENCES MD_DESA(KD_DESA) ON UPDATE CASCADE ON DELETE RESTRICT,

    CONSTRAINT FK_D_PEGAWAI_KD_PROVINSI_ASAL FOREIGN KEY (KD_PROVINSI_ASAL) REFERENCES MD_PROVINSI(KD_PROVINSI) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_KABUPATEN_ASAL FOREIGN KEY (KD_KABUPATEN_ASAL) REFERENCES MD_KABUPATEN(KD_KABUPATEN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_KECAMATAN_ASAL FOREIGN KEY (KD_KECAMATAN_ASAL) REFERENCES MD_KECAMATAN(KD_KECAMATAN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_PEGAWAI_KD_DESA_ASAL FOREIGN KEY (KD_DESA_ASAL) REFERENCES MD_DESA(KD_DESA) ON UPDATE CASCADE ON DELETE RESTRICT
);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_JABATAN;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_JABATAN(
    KD_RIWAYAT_JABATAN	VARCHAR	(30),
    UID_USER	        VARCHAR	(50),
    KD_JABATAN	        VARCHAR	(10),
    KD_JABATAN_SEBELUM	VARCHAR	(10),
    TMT_JABATAN	        DATE,
    TMT_AKHIR_JABATAN	DATE,
    IS_DELETED	        BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_JABATAN),
    CONSTRAINT FK_D_RIWAYAT_JABATAN_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_RIWAYAT_JABATAN_KD_JABATAN FOREIGN KEY (KD_JABATAN) REFERENCES MD_JABATAN(KD_JABATAN)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_RIWAYAT_JABATAN_KD_JABATAN_S FOREIGN KEY (KD_JABATAN_SEBELUM) REFERENCES MD_JABATAN(KD_JABATAN)  ON UPDATE CASCADE ON DELETE RESTRICT
);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_PANGKAT;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_PANGKAT(
    KD_RIWAYAT_PANGKAT	VARCHAR	(30),
    UID_USER	        VARCHAR	(50),
    KD_PANGKAT	        VARCHAR	(10),
    KD_PANGKAT_SEBELUM	VARCHAR	(10),
    TMT_PANGKAT	        DATE,
    TMT_AKHIR_PANGKAT	DATE,
    IS_DELETED	        BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_PANGKAT),
    CONSTRAINT FK_D_R_PANGKAT_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PANGKAT_KD_PANGKAT FOREIGN KEY (KD_PANGKAT) REFERENCES MD_PANGKAT(KD_PANGKAT)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PANGKAT_KD_PANGKAT_S FOREIGN KEY (KD_PANGKAT_SEBELUM) REFERENCES MD_PANGKAT(KD_PANGKAT)  ON UPDATE CASCADE ON DELETE RESTRICT
);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_SEKSI;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_SEKSI(
    KD_RIWAYAT_SEKSI	VARCHAR	(30),
    UID_USER	        VARCHAR	(50),
    KD_SEKSI	        VARCHAR	(10),
    KD_SEKSI_SEBELUM	VARCHAR	(10),
    TMT_SEKSI	        DATE,
    TMT_AKHIR_SEKSI	    DATE,
    KD_DEPARTEMEN	    VARCHAR	(10),
    KD_DIREKSI	        VARCHAR	(10),
    IS_DELETED	        BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_SEKSI),
    CONSTRAINT FK_D_R_SEKSI_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_SEKSI_KD_SEKSI FOREIGN KEY (KD_SEKSI) REFERENCES MD_SEKSI(KD_SEKSI)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_SEKSI_KD_SEKSI_S FOREIGN KEY (KD_SEKSI_SEBELUM) REFERENCES MD_SEKSI(KD_SEKSI)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_SEKSI_KD_DEPARTEMEN FOREIGN KEY (KD_DEPARTEMEN) REFERENCES MD_DEPARTEMEN(KD_DEPARTEMEN)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_SEKSI_KD_DIREKSI FOREIGN KEY (KD_DIREKSI) REFERENCES MD_DIREKSI(KD_DIREKSI)  ON UPDATE CASCADE ON DELETE RESTRICT

);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_BOD;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_BOD(
    KD_RIWAYAT_BOD	VARCHAR	(30),
    UID_USER	    VARCHAR	(50),
    KD_BOD	        VARCHAR	(10),
    KD_BOD_SEBELUM	VARCHAR	(10),
    TMT_BOD	        DATE,
    TMT_AKHIR_BOD	DATE,	
    IS_DELETED	    BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_BOD),
    CONSTRAINT FK_D_R_K_TUGAS_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_BOD_KD_BOD FOREIGN KEY (KD_BOD) REFERENCES MD_BOD(KD_BOD)  ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_BOD_KD_BOD_S FOREIGN KEY (KD_BOD_SEBELUM) REFERENCES MD_BOD(KD_BOD)  ON UPDATE CASCADE ON DELETE RESTRICT
);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_KELOMPOK_TUGAS;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_KELOMPOK_TUGAS(
    KD_RIWAYAT_KELOMPOK_TUGAS	VARCHAR	(30),
    UID_USER	                VARCHAR	(50),
    KD_KELOMPOK_TUGAS	        VARCHAR	(10),
    KD_KELOMPOK_TUGAS_SEBELUM	VARCHAR	(10),
    TMT_KELOMPOK_TUGAS	        DATE,
    TMT_AKHIR_KELOMPOK_TUGAS	DATE,
    IS_DELETED	                BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_KELOMPOK_TUGAS),
    CONSTRAINT FK_D_R_K_TUGAS_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_K_TUGAS_KD_KEL_TUGAS FOREIGN KEY (KD_KELOMPOK_TUGAS) REFERENCES MD_KELOMPOK_TUGAS(KD_KELOMPOK_TUGAS)  ON UPDATE CASCADE ON DELETE RESTRICT,    
    CONSTRAINT FK_D_R_K_TUGAS_KD_KEL_TUGAS_S FOREIGN KEY (KD_KELOMPOK_TUGAS_SEBELUM) REFERENCES MD_KELOMPOK_TUGAS(KD_KELOMPOK_TUGAS)  ON UPDATE CASCADE ON DELETE RESTRICT    
);

-- DROP TABLE IF EXISTS PEGAWAI.D_RIWAYAT_PENDIDIKAN;
CREATE TABLE IF NOT EXISTS PEGAWAI.D_RIWAYAT_PENDIDIKAN(
    KD_RIWAYAT_PENDIDIKAN	VARCHAR	(30),
    UID_USER	            VARCHAR	(50),
    KD_JENJANG	            VARCHAR	(25),
    NM_SEKOLAH	            VARCHAR	(1000),
    KD_JURUSAN	            VARCHAR	(25),
    STATUS_PENDIDIKAN	    VARCHAR	(5) DEFAULT 'L',
    THN_TAMAT	            DATE,
    KD_PROVINSI	            INTEGER,
    KD_KABUPATEN	        INTEGER,
    KD_KECAMATAN	        INTEGER,
    KD_DESA	                INTEGER,
    STATUS	                STATUS,
    IS_DELETED	            BOOLEAN,

    PRIMARY KEY (KD_RIWAYAT_PENDIDIKAN),
    CONSTRAINT FK_D_R_PEND_UID_USER FOREIGN KEY (UID_USER) REFERENCES MD_USER(UID_USER) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PEND_KD_JENJANG FOREIGN KEY (KD_JENJANG) REFERENCES MD_JENJANG(KD_JENJANG) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PEND_KD_JURUSAN FOREIGN KEY (KD_JURUSAN) REFERENCES MD_JURUSAN(KD_JURUSAN) ON UPDATE CASCADE ON DELETE RESTRICT,

    CONSTRAINT FK_D_R_PEND_KD_PROVINSI FOREIGN KEY (KD_PROVINSI) REFERENCES MD_PROVINSI(KD_PROVINSI) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PEND_KD_KABUPATEN FOREIGN KEY (KD_KABUPATEN) REFERENCES MD_KABUPATEN(KD_KABUPATEN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PEND_KD_KECAMATAN FOREIGN KEY (KD_KECAMATAN) REFERENCES MD_KECAMATAN(KD_KECAMATAN) ON UPDATE CASCADE ON DELETE RESTRICT,
    CONSTRAINT FK_D_R_PEND_KD_DESA FOREIGN KEY (KD_DESA) REFERENCES MD_DESA(KD_DESA) ON UPDATE CASCADE ON DELETE RESTRICT
);
