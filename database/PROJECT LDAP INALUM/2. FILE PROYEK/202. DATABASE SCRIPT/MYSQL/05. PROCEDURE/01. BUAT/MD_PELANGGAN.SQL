CREATE OR REPLACE FUNCTION P_ISI_MD_PELANGGAN(
	KD_PELANGGAN1 character varying,
	NM_PELANGGAN1 character varying,
	ALAMAT1 character varying,
	NO_HP1 character varying,
	EMAIL1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_PELANGGAN WHERE KD_PELANGGAN = KD_PELANGGAN1;
	IF CACAH > 0 THEN
		UPDATE MD_PELANGGAN SET NM_PELANGGAN = NM_PELANGGAN1, ALAMAT = ALAMAT1, NO_HP = NO_HP1, EMAIL = EMAIL1 WHERE KD_PELANGGAN = KD_PELANGGAN1;
	ELSE
		INSERT INTO MD_PELANGGAN VALUES(KD_PELANGGAN1, NM_PELANGGAN1, ALAMAT1, NO_HP1, EMAIL1);
	END IF;

	RETURN 'OKE';
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;


-- DELETE
CREATE OR REPLACE FUNCTION P_DEL_MD_PELANGGAN(
	KD_PELANGGAN1 character varying
)
RETURNS character varying AS 
$BODY$
DECLARE 
	CACAH NUMERIC;
	ERR_MSG VARCHAR;
BEGIN
	SELECT COUNT(*) INTO CACAH FROM MD_PELANGGAN WHERE KD_PELANGGAN = KD_PELANGGAN1;
	IF CACAH > 0 THEN
		DELETE FROM MD_PELANGGAN WHERE KD_PELANGGAN = KD_PELANGGAN1;
		ERR_MSG := 'OKE';
	ELSE
		ERR_MSG := 'GAGAL';
	END IF;

	RETURN ERR_MSG;
END;
$BODY$
	LANGUAGE plpgsql VOLATILE;